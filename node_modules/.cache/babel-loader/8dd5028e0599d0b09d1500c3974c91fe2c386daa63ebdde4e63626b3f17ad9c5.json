{"ast":null,"code":"import shortid from 'shortid';\nimport noImage from '../../assets/img/no-image-cover.jpg';\nclass ApiService {\n  constructor() {\n    this._apiBase = 'https://www.googleapis.com/books/v1/volumes?q=';\n    this._apiKey = 'AIzaSyC94t_G6IWhYkb9HAJ-_Zv-qFh-MaGkT4M';\n    this.books = [];\n    this.getResource = async url => {\n      let res = await fetch(url);\n      if (!res.ok) {\n        throw new Error(`Could not fetch ${url}, status ${res.status}`);\n      }\n      return await res.json();\n    };\n    this.getBooks = async startIndex => {\n      const res = await this.getResource(`${this._apiBase}\"subject:Drama\"&printType=books&startIndex=${startIndex}&maxResults=6&key=${this._apiKey}`);\n      return res;\n    };\n    // получаю массив книг по категории\n    this.getSelectedBooks = async category => {\n      const res = await this.getResource(`${this._apiBase}\"subject:${category}\"&startIndex=0&maxResults=6&key=${this._apiKey}`);\n      this.books = [];\n      for (let i = 0; i < res.items.length; i++) {\n        this.books.push(this._transformBooks(res.items[i]));\n      }\n      return this.books;\n    };\n    this.getPagination = async (activeCategory, startIndex) => {\n      let index = startIndex * 6;\n      const res = await this.getResource(`${this._apiBase}subject:${activeCategory}&printType=books&startIndex=${index}&maxResults=6&key=${this._apiKey}`);\n      for (let i = 0; i < res.items.length; i++) {\n        this.books.push(this._transformBooks(res.items[i]));\n      }\n      return this.books;\n    };\n    this.renderRating = rating => {\n      const fullStars = Math.floor(rating / 1);\n      const halfStar = rating % 1 >= 0.5 ? '★' : '';\n      const emptyStars = 5 - fullStars - halfStar.length;\n      return '★'.repeat(fullStars) + halfStar + '☆'.repeat(emptyStars);\n    };\n    this.id = shortid.generate();\n    // перезаписываю массив удаляя все лишнее \n    this._transformBooks = books => {\n      return {\n        etag: books.etag,\n        isbn: books.volumeInfo.industryIdentifiers[0].identifier,\n        title: books.volumeInfo.title ? `${books.volumeInfo.title.slice(0, 30)}...` : 'No title',\n        author: books.volumeInfo.authors && books.volumeInfo.authors.length > 0 ? books.volumeInfo.authors.join(', ') : 'there is no author',\n        description: books.volumeInfo.description ? `${books.volumeInfo.description.slice(0, 90)}...` : 'There is no description for this book',\n        thumbnail: books.volumeInfo.imageLinks && books.volumeInfo.imageLinks.thumbnail ? books.volumeInfo.imageLinks.thumbnail : noImage,\n        ratingsCount: books.volumeInfo.ratingsCount ? `${books.volumeInfo.ratingsCount} reviews` : 'no reviews',\n        averageRating: books.volumeInfo.averageRating ? this.renderRating(books.volumeInfo.averageRating) : null,\n        saleInfo: books.volumeInfo.saleInfo && `$${books.volumeInfo.saleInfo.retailPrice}` ? books.volumeInfo.saleInfo.retailPrice : null\n      };\n    };\n  }\n}\nexport default ApiService;","map":{"version":3,"names":["shortid","noImage","ApiService","constructor","_apiBase","_apiKey","books","getResource","url","res","fetch","ok","Error","status","json","getBooks","startIndex","getSelectedBooks","category","i","items","length","push","_transformBooks","getPagination","activeCategory","index","renderRating","rating","fullStars","Math","floor","halfStar","emptyStars","repeat","id","generate","etag","isbn","volumeInfo","industryIdentifiers","identifier","title","slice","author","authors","join","description","thumbnail","imageLinks","ratingsCount","averageRating","saleInfo","retailPrice"],"sources":["C:/Users/OZON/PycharmProjects/BookStore/src/components/services/ApiServices.js"],"sourcesContent":["import shortid from 'shortid';\nimport noImage from '../../assets/img/no-image-cover.jpg'\n\n\nclass ApiService{\n\n    _apiBase = 'https://www.googleapis.com/books/v1/volumes?q=';\n    _apiKey = 'AIzaSyC94t_G6IWhYkb9HAJ-_Zv-qFh-MaGkT4M';\n    books = [];\n\n    getResource = async (url) => {\n      let res = await fetch(url);\n\n      if(!res.ok) {\n        throw new Error (`Could not fetch ${url}, status ${res.status}`);\n      }\n      \n      return await res.json();\n    } \n   \n    getBooks = async (startIndex) => {\n      const res = await this.getResource(`${this._apiBase}\"subject:Drama\"&printType=books&startIndex=${startIndex}&maxResults=6&key=${this._apiKey}`);\n      return res\n    }\n    \n    // получаю массив книг по категории\n    getSelectedBooks = async (category) => {\n      const res = await this.getResource(`${this._apiBase}\"subject:${category}\"&startIndex=0&maxResults=6&key=${this._apiKey}`); \n      this.books = []; \n      for (let i = 0; i < res.items.length; i++) {\n        this.books.push((this._transformBooks(res.items[i])));\n        \n      }  \n     \n      return this.books;\n    }\n    \n    getPagination = async (activeCategory, startIndex ) => {\n      let index =  startIndex * 6\n      const res = await this.getResource(`${this._apiBase}subject:${activeCategory}&printType=books&startIndex=${index}&maxResults=6&key=${this._apiKey}`);\n      for (let i = 0; i < res.items.length; i++) {\n        this.books.push(this._transformBooks(res.items[i]));\n      }\n      return this.books;\n    }\n   \n    renderRating = (rating) => {\n      const fullStars = Math.floor(rating / 1);\n      const halfStar = (rating % 1) >= 0.5 ? '★' : '';\n      const emptyStars = 5 - fullStars - halfStar.length;\n      return '★'.repeat(fullStars) + halfStar + '☆'.repeat(emptyStars);\n    }\n    id = shortid.generate();\n    \n     // перезаписываю массив удаляя все лишнее \n    _transformBooks = (books) => {\n      return {\n            etag: books.etag,\n            isbn: books.volumeInfo.industryIdentifiers[0].identifier,\n            title: books.volumeInfo.title ? `${books.volumeInfo.title.slice(0, 30)}...` : 'No title',\n            author: books.volumeInfo.authors && books.volumeInfo.authors.length > 0 ? books.volumeInfo.authors.join(', ') : 'there is no author',\n            description: books.volumeInfo.description ? `${books.volumeInfo.description.slice(0, 90)}...` : 'There is no description for this book',\n            thumbnail: books.volumeInfo.imageLinks && books.volumeInfo.imageLinks.thumbnail ? books.volumeInfo.imageLinks.thumbnail : noImage,\n            ratingsCount: books.volumeInfo.ratingsCount ? `${books.volumeInfo.ratingsCount} reviews` : 'no reviews',\n            averageRating: books.volumeInfo.averageRating ? this.renderRating(books.volumeInfo.averageRating) : null,\n            saleInfo: books.volumeInfo.saleInfo && `$${books.volumeInfo.saleInfo.retailPrice}` ? books.volumeInfo.saleInfo.retailPrice : null,\n      }\n    }\n  \n    \n}\n\nexport default ApiService;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}